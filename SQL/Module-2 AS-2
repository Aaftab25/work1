CREATE TABLE employee
(
    employee_id INT NOT NULL PRIMARY KEY,
    first_name VARCHAR(25),
    last_name VARCHAR(25),
    date_of_birth DATE,
    salary INT,
    joining_date DATETIME,
    department VARCHAR(25),
    phone int
);


INSERT INTO employee
VALUEs
(1 , 'John', 'Abraham', '1996-02-22', 400000, '2013-05-01 12.00.00', 'Banking',9988777855),
(2 , 'Michael' ,'Clarke', '1999-06-22', 800000 ,'2013-01-02 12.00.00' ,'Insurance',9988776655 ),
(3 , 'Roy' ,'Thomas', '1971-04-01', 700000 ,'2013-01-03 12.00.00' ,'Banking',9985677665 ),
(4 , 'Tom' ,'Jose', '1994-012-22', 600000 ,'2013-01-04 12.00.00' ,'Insurance',9914576655 ),
(5 , 'Jerry' ,'Pinto', '1979-09-12', 650000 ,'2013-01-02 12.00.00' ,'Insurance',9988752455 ),
(6 , 'Philip' ,'Mathew', '1982-04-15', 750000 ,'2013-01-02 12.00.00' ,'Services',9984456655 ),
(7 , 'TestName1' ,'123', '1987-04-22', 650000 ,'2013-01-07 12.00.00' ,'Services',9988235655 ),
(8 , 'TestName2' ,'Lname%', '1999-04-02', 600000 ,'2013-01-07 12.00.00' ,'Insurance',9986586655 ),
(9 , 'Sem' ,'Abraham', '1989-01-12', 2000000 ,'2013-01-07 12.00.00', 'Finance',9425776655 ),
(10, 'Amanadil', 'Abraham', '1988-04-28', 400000, '2013-05-01 12.00.00', 'Banking',9984126655);

-------------- 1. Write a query that displays the first name and the length of the first name for all employees whose name starts with the letters 'A', 'J' or 'M'. Give each column an appropriate label. Sort the results by the employees' first names'. --------------
                SELECT * FROM employee WHERE First_Name like 'M%' or first_name like 'J%' or first_name like 'A%';

-------------- 2. Write a query to display the first name and salary for all employees. Format the salary to be 10 characters long, left-padded with the $ symbol. Label the column SALARY. ------------------------------------------------------------------------------
                SELECT first_name, LPAD(salary,10,'$') as SALARY FROM employee 

-------------- 3. Write a query to display the employees with their code, first name, last name and hire date who hired either on seventh day of any month or seventh month in any year. ---------------------------------------------------------------------------------
                SELECT employee_id, first_name, last_name,JOINING_DATE FROM employee WHERE DAY(JOINING_DATE) = 7 OR MONTH(JOINING_DATE) = 7;

-------------- 4. Write a query to display the length of first name for employees where last name contain character 'c' after 2nd position. ------------------------------------------------------------------------------------------------------------------------------
                SELECT first_name, length(first_name) as F_Length , last_name FROM employee WHERE instr(last_name, 'C')>2;

-------------- 5. Write a query to extract the last 4 character of phone numbers. ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT RIGHT(phone, 4) as ExtractNUmber FROM employee;
                
-------------- 6. Write a query to update the portion of the phone_number in the employees table, within the phone number the substring '124' will be replaced by '999'. -------------------------------------------------------------------------------------------------
                SELECT REPLACE(phone, 124,999) FROM employee;

-------------- 7. Write a query to calculate the age in year. ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                select year(CURDATE())-year(date_of_birth) as Age from employee
-------------- 8. Write a query to get the distinct Mondays from hire_date in employees tables. --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT DISTINCT * from employee where dayname(joining_date)  = 'Monday'

-------------- 9. Write a query to get the first name and hire date from employees table where hire date between '1987-06-01' and '1987-07-30' ---------------------------------------------------------------------------------------------------------------------------
                SELECT * FROM employee WHERE joining_date BETWEEN '1987-06-01' AND '1987-07-30';

-------------- 10. Write a query to display the current date in the following format. ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT CURDATE()
-------------- 11. Sample output : 12:00 AM Sep 5, 2014 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

                SELECT date_format(CURDATE(), "%r %b %Y") ;

-------------- 12. Write a query to get the firstname, lastname who joined in the month of June. -------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT first_name,last_name FROM employee  WHERE MONTHNAME(joining_date) = 'june';

-------------- 13. Write a query to get employee ID, last name, and date of first salary of the employees. ---------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT employee_Id, last_name, last_day(joining_date) FROM employee;

-------------- 14. Write a query to get first name, hire date and experience of the employees. ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT first_name, joining_date, DATEDIFF(sysdate(),joining_date)/365 from employee;

-------------- 15. Write a query to get first name of employees who joined in 1987. --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT first_name FROM  employee WHERE YEAR(joining_date) = 1987;
-------------- 16. Write a query to rank employees based on their salary for a month -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        ------------------------------------------------ DENSE RANK -------------------------------------
                SELECT *, DENSE_RANK() OVER(order by salary DESC ) d_rank FROM employee;		

        ------------------------------------------------  RANK -------------------------------------
                SELECT *, RANK() OVER(order by salary DESC ) as Ranks FROM employee;	

        ------------------------------------------------ Row Number -------------------------------------
                SELECT *, ROW_NUMBER() OVER (Order BY salary desc)as Row_Rank FROM employee;
-------------- 17. Select 4th Highest salary from employee table using ranking function-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                SELECT * FROM (SELECT *, DENSE_RANK() OVER (order BY salary desc)as d_rank FROM employee)employee WHERE d_rank = 4;


         